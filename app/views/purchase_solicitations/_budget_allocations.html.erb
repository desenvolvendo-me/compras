<div id="budget_allocations_selector">
  <%= f.error :purchase_solicitation_budget_allocations %>

  <p>
    <input type="button" class="button affirmative add-purchase-solicitation-budget-allocation"<%= data_disabled_attribute(f.object.decorator.is_annulled_message) %> value="Adicionar Dotação">
  </p>

  <div id="allocations">
    <%= f.association :purchase_solicitation_budget_allocations, :collection => localized(f.object.purchase_solicitation_budget_allocations) do |p| %>
      <%= render 'purchase_solicitation_budget_allocations/form', :f => p, :data_disabled => f.object.decorator.is_annulled_message %>
    <% end %>
  </div>
</div>

<%= mustache 'purchase-solicitation-budget-allocations-template' do %>
  <%= f.association :purchase_solicitation_budget_allocations_attributes, :collection => f.object.purchase_solicitation_budget_allocations.build, :index => '{{uuid_purchase_solicitation_budget_allocation}}' do |p| %>
    <%= render 'purchase_solicitation_budget_allocations/form', :f => p, :data_disabled => nil %>
  <% end %>
<% end %>

<script>
  $("#purchase-solicitation-budget-allocations-template").nestedForm({
    add: '.add-purchase-solicitation-budget-allocation',
    remove: '.remove-purchase-solicitation-budget-allocation',
    target: '#allocations',
    uuid: 'uuid_purchase_solicitation_budget_allocation',
    fieldsWrapper: '.purchase-solicitation-budget-allocation',
    appendItem: false
  });
</script>
