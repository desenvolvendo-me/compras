<div class="yui3-g">
  <div class="yui3-u-1-2">
    <%= f.input :entity %>
  </div>

  <div class="yui3-u-1-2">
    <%= f.input :year %>
  </div>
</div>

<%= f.input :pledge, :modal_url => modal_pledges_path(:global_or_estimated => true) %>
<%= f.input :pledge_creditor, :disabled => true %>

<div class="yui3-g">
  <div class="yui3-u-1-3">
    <%= f.input :emission_date, :disabled => true, :input_html => { :value => f.object.presenter.emission_date } %>
  </div>

  <div class="yui3-u-1-3">
    <%= f.input :pledge_value, :disabled => true, :input_html => { :value => f.object.presenter.pledge_value } %>
  </div>

  <div class="yui3-u-1-3">
    <%= f.input :balance, :disabled => true, :input_html => { :value => f.object.presenter.balance } %>
  </div>
</div>

<%= f.input :number, :disabled => true %>
<%= f.input :creditor %>
<div class="yui3-g">
  <div class="yui3-u-1-2">
    <%= f.input :date %>
  </div>

  <div class="yui3-u-1-2">
    <%= f.input :value %>
  </div>
</div>
<%= f.input :process_number %>
<%= f.input :description %>

<script>
  <% if f.object.persisted? %>
    $('form.subpledge :input').attr('disabled', true);
  <% else %>
      $('#subpledge_pledge_id').change(function(event, data) {
        if (data) {
          var record = data.record;
          $('#subpledge_pledge_creditor').val(record.data("creditor"));
          $('#subpledge_emission_date').val(record.data("emission-date"));
          $('#subpledge_pledge_value').val(record.data("pledge-value"));
          $('#subpledge_balance').val(record.data("balance"));
          $('#subpledge_value').val(record.data("balance"));
          $('#subpledge_creditor_id').val(record.data("creditor-id"));
          $('#subpledge_creditor').val(record.data("creditor"));
          $('#subpledge_description').val(record.data("description"));
        } else {
          $('#subpledge_pledge_creditor').val('');
          $('#subpledge_emission_date').val('');
          $('#subpledge_pledge_value').val('');
          $('#subpledge_balance').val('');
        }
      });
  <% end %>
</script>
