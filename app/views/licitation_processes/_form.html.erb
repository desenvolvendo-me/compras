<div class="tabs" id="licitation_process">
  <ul id="main-ul">
    <li><a href="#tab-main">Dados do Processo</a></li>
    <li><a href="#tab-requestor">Solicitantes</a></li>
    <li><a href="#tab-items" id="items_tab_header">Itens / Justificativa</a></li>
    <li><a href="#tab-periods">Prazos</a></li>
    <li class='income'><a href="#tab-income">Receita</a></li>
    <li><a href="#tab-documents">Documentos</a></li>
    <li id="legal_reasons_tab" ><a href="#tab-leagal-reasons">Fundamentação Legal Dispensa/Inexigibilidade</a></li>
    <li><a href="#tab-legal-analysis-appraisals" id="legal_analysis_appraisals_tab">Laudo de Análise Jurídica</a></li>
    <li><a href="#tab-licitation-process-publications" id="licitation_process_publications_tab">Publicações</a></li>

    <%= content_tag :li, class:('hided' unless resource.trading?) do%>
      <a href="#tab-licitation-purchase-process-accreditations" id="purchase_process_accreditations">Credenciamentos</a>
    <% end %>

    <li><a href="#tab-bidders" id="bidder">Habilitação</a></li>

    <%= content_tag :li, class:('hided' unless resource.licitation? || resource.new_record? ) do%>
      <a href="#tab-proposals" id="proposals">Propostas</a>
    <% end %>

    <%= content_tag :li, class:('hided' unless resource.trading?) do%>
      <a href="#tab-tradings" id="tradings">Lances</a>
    <% end %>

    <%= content_tag :li, class:('hided' unless resource.trading?) do%>
      <li><a href="#tab-realignment-prices" id="realignment_prices">Realinhamento de Preços</a></li>
    <% end %>

    <%= content_tag :li, class:('hided' unless resource.trading?) do%>
      <a href="#tab-trading-negotiation" id="trading_negotiation">Negociação</a>
    <% end %>

    <li><a href="#tab-judgment-commission" id="judgment_commission">Parecer da Comissão Julgadora</a></li>

    <li><a href="#tab-ratifications" id="ratifications">Adjudicação/Homologação</a></li>
  </ul>

  <div id="tab-main"><%= render 'main', :f => f %></div>
  <div id="tab-requestor"><%= render 'requestor', :f => f %></div>
  <div id="tab-periods"><%= render 'periods', :f => f %></div>
  <div id="tab-items"><%= render 'items', :f => f %></div>
  <div id="tab-income"><%= render 'income', :f => f %></div>
  <div id="tab-documents"><%= render 'documents', :f => f %></div>
  <div id="tab-leagal-reasons"><%= render 'legal_reasons', :f => f %></div>
  <div id="tab-legal-analysis-appraisals"><%= render 'legal_analisys_appraisals', :f => f %></div>

  <div id="tab-licitation-process-publications"><%= render 'licitation_process_publications', :f => f %></div>
  <div id="tab-licitation-purchase-process-accreditations"><%= render 'purchase_process_accreditations', :f => f %></div>
  <div id="tab-bidders"><%= render 'bidders', :f => f %></div>
  <div id="tab-proposals"><%= render 'purchase_process_proposals', :f => f %></div>
  <div id="tab-tradings"><%= render 'purchase_process_tradings', :f => f %></div>
  <div id="tab-realignment-prices"><%= render 'realignment_prices', :f => f %></div>
  <div id="tab-trading-negotiation"><%= render 'purchase_process_trading_negotiation', :f => f %></div>
  <div id="tab-judgment-commission"><%= render 'judgment_commission_advices', :f => f %></div>
  <div id="tab-ratifications"><%= render 'licitation_process_ratifications', :f => f %></div>


</div>

<%= f.object.errors.full_messages %>

<style>
  .hided{
    display: none;
  }
</style>

<script>


  <% if resource.approved? %>
    $(function(){
      $('form.licitation_process [data-disabled]').on('click', function(event){
        event.stopImmediatePropagation();
        return false;
      });
      $('form.licitation_process :input').not('[data-disabled]').attr('disabled', true);
      $('#licitation_process_budget_allocation').removeAttr('disabled');
      $('#licitation_process_purchase_process_budget_allocation_value').removeAttr('disabled');
      $('#licitation_process_budget_allocation_year').removeAttr('disabled');
      $('#purchase_process_budget_allocations_button').removeAttr('disabled');
      $('#licitation_process_submit').removeAttr('disabled');
      $('form input[type="hidden"]').removeAttr('disabled');
      $('form input[name="authenticity_token"]').removeAttr('disabled');
      $('form input[name="_method"]').removeAttr('disabled');
      $('form input[name="licitation_process_nested_grid_[id]"]').removeAttr('disabled');
      $('#licitation_process_expense_nature').removeAttr('disabled');
      $('#licitation_process_expense_nature_id').removeAttr('disabled');
    });
  <% end %>



  $(function(){
    var disabled = '',
        $main_tab = $("#licitation_process");

    <% if f.object.persisted? %>
      <% if f.object.trading? %>
        disabled = '<%= f.object.decorator.must_have_published_edital %>';
        if (disabled !== ''){
          $("#purchase_process_accreditations").attr('data-disabled', disabled);
          $main_tab.tabs( "disable", $("#purchase_process_accreditations").parent().index());
        }

        disabled = '<%= f.object.decorator.must_have_published_edital_or_direct_purchase_or_disabled_negotiation_message%>';
        if (disabled !== ''){
          $("#bidder").attr('data-disabled', disabled);
          $main_tab.tabs( "disable", $("#bidder").parent().index());
        }

        disabled = '<%= f.object.decorator.disabled_negotiation_message%>';
        if (disabled !== ''){
          $("#ratifications").attr('data-disabled', disabled);
          $main_tab.tabs( "disable", $("#ratifications").parent().index());
        }

        disabled = '<%= f.object.decorator.disabled_negotiation_message%>';
        if (disabled !== ''){
          $("#trading_negotiation").attr('data-disabled', disabled);
          $main_tab.tabs( "disable", $("#trading_negotiation").parent().index());
        }



        <% if f.object.decorator.enabled_realignment_price? %>
          disabled = '<%= f.object.decorator.must_have_creditors_and_items%>';
          if (disabled !== ''){
            $("#realignment_prices").attr('data-disabled', disabled);
            $main_tab.tabs( "disable", $("#realignment_prices").parent().index());
          }
        <% end %>
      <% end %>

      <% unless f.object.trading? %>
        disabled = '<%= f.object.decorator.must_have_published_edital_or_direct_purchase %>';
        if (disabled !== ''){
          $("#bidder").attr('data-disabled', disabled);
          $main_tab.tabs( "disable", $("#bidder").parent().index());
        }

        <% if f.object.decorator.enabled_realignment_price? %>
          disabled = '<%= f.object.decorator.must_have_creditors_and_items%>';
          if (disabled !== ''){
            $("#realignment_prices").attr( 'data-disabled', disabled);
            $main_tab.tabs( "disable", $("#realignment_prices").parent().index());
          }
        <% end %>

        <% if f.object.trading.present? %>
          disabled = '<%= f.object.decorator.disabled_negotiation_message%>';
          if (disabled !== ''){
            $("#trading_negotiation").attr('data-disabled', disabled);
            $main_tab.tabs( "disable", $("#trading_negotiation").parent().index());
          }
        <% end %>
      <% end %>

      <% if f.object.licitation? %>
        disabled = '<%= f.object.decorator.must_have_creditors_and_items%>';
        if (disabled !== ''){
          $("#proposals").attr('data-disabled', disabled);
          $main_tab.tabs( "disable", $("#proposals").parent().index());
        }
      <% end %>

      <% if f.object.licitation? %>
        disabled = '<%= f.object.decorator.disabled_trading_message%>';
        if (disabled !== ''){
          $("#tradings").attr('data-disabled', disabled);
          $main_tab.tabs( "disable", $("#tradings").parent().index());
        }
      <% end %>
    <% end %>

  })
</script>
