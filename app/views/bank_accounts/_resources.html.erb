<p>
  <input type="button" class="button affirmative add-bank-account-capability" value="Adicionar">
</p>

<div id="bank-account-capability" data-nested-form="bank-account-capability" data-append-item=false>
  <%= f.association :capabilities, :collection => localized(f.object.capabilities) do |p| %>
    <%= render 'bank_account_capabilities/form', :f => p %>
  <% end %>
</div>

<%= mustache 'bank-account-capability-template' do %>
  <%= f.association :capabilities_attributes,
                    :collection => f.object.capabilities.build(:status => Status::ACTIVE, :date => I18n.l(Date.current)),
                    :index => '{{uuid-bank-account-capability}}' do |p| %>
    <%= render 'bank_account_capabilities/form', :f => p %>
  <% end %>
<% end %>

<script>
  $('.add-bank-account-capability').click(function() {
    var currentDate = "<%= I18n.l(Date.current) %>";

    $('.select-status option:selected[value="<%= Status::ACTIVE %>"]').closest(".nested-bank-account-capability").find('.input-date').val(currentDate);

    $('select.select-status').val('<%= Status::INACTIVE %>');
    $('select.select-status[selected="<%= Status::ACTIVE %>"]').val('<%= Status::INACTIVE %>');
  });
</script>
