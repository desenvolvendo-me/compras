<div class="yui3-g">
  <div class="yui3-u-1-3">
    <%= f.input :year, :disabled => f.object.updatabled %>
  </div>

  <div class="yui3-u-1-3">
    <%= f.input :licitation_process, :required => true, :disabled => f.object.updatabled %>
  </div>

  <div class="yui3-u-1-3">
    <%= f.input :modality_or_type_of_removal, as: :fake, disabled: true,
                input_html: {value: f.object.decorator.modality_or_type_of_removal} %>
  </div>
</div>

<div class="yui3-g">
  <div class="yui3-u-1-4 hidden">
    <%= f.input :updatabled %>
  </div>

  <div class="yui3-u-1-4">
    <%= f.input :authorization_date, :disabled => f.object.updatabled %>
  </div>

  <div class="yui3-u-1-4">
    <%= f.input :pledge, :disabled => f.object.updatabled %>
    <%#= f.input :pledge, as: :auto_complete, source_path: pledges_path,
      hidden_field: :pledge_id %>
    <%#= f.error :pledge_id %>
  </div>

  <div class="yui3-u-1-4">
    <%= f.input :contract, :disabled => f.object.updatabled %>
  </div>

  <div class="yui3-u-1-4">
    <div>
      <label> Fornecedor </label>
      <input class="string" disabled id="supply_request_creditor"
             value="<%= f.object.decorator.creditor %>" size="30" type="text" >
    </div>
  </div>

</div>

<div class="yui3-g">
  <div class="yui3-u-1-4">
    <%= f.input :purchase_solicitation, :disabled => f.object.licitation_process.nil? || f.object.updatabled %>
  </div>

  <div class="yui3-u-1-4">
    <div class="input integer">
      <label class="numeric integer ">Departamento</label>
      <input class="string integer" type="text" id="purchase_solicitation_department" value="<%= f.object.purchase_solicitation.department if f.object.purchase_solicitation %>" disabled>
    </div>
  </div>

</div>

<div id="supply_request_items">

  <div class="nested-fields add-margin-bottom">
    <%= hidden_field_tag :item_id, nil, :name => 'supply_request_item[id]' %>

    <div class="yui3-g">
      <div class="yui3-u-1-3">
        <%= f.input :material, :as => :auto_complete, :fake => true,
                    :source_path => materials_path(:by_licitation_process => f.object.licitation_process),
                    :required => true %>
      </div>
      <div class="yui3-u-1-3">
        <%= f.input :quantity, :as => :fake, :required => true %>
      </div>
      <div class="yui3-u-1-3">
        <div class="input fake required supply_request_balance">
          <label class="fake required" for="supply_request_balance">Saldo</label>
          <input class="string fake required" id="supply_request_balance" name="supply_request[balance]" type="text" readonly>
        </div>
      </div>
    </div>

    <div class="yui3-u-1-6">
      <%= button_tag 'Adicionar', type: :button,
                     :class => 'button add-nested-record field-without-label',
                     'data-template' => 'licitation_process_items_template',
                     'data-records' => 'items-records',
                     'data-disabled' => not_updateable_message %>
    </div>
  </div>

  <%= f.error :items %>

  <table id="items-records" class="records">
    <thead>
    <tr>
      <th><%= SupplyRequestItem.human_attribute_name :material %></th>
      <th><%= SupplyRequestItem.human_attribute_name :quantity %></th>
      <th></th>
      <th></th>
    </tr>
    </thead>
    <tbody>
    <%= f.association :items, :collection => localized(f.object.items) do |p| %>
      <%= render 'supply_request_items/form',
                 id: p.object.id,
                 material: p.object.material,
                 material_id: p.object.material_id,
                 quantity: p.object.quantity,
                 f: p %>
    <% end %>
    </tbody>
  </table>

  <%= mustache "licitation_process_items_template" do %>
    <%= f.association :items_attributes, :collection => f.object.items.build, :index => '{{uuid}}' do |p| %>
      <%= render 'supply_request_items/form',
                 id: '{{id}}',
                 material: '{{material}}',
                 material_id: '{{material_id}}',
                 quantity: '{{quantity}}',
                 f: p %>
    <% end %>
  <% end %>
</div>