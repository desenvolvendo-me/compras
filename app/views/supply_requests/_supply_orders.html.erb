<% if f.object.updatabled && f.object.persisted? && @hidden_field%>
  <button type='button' class="button primary" id="gen-suplly-order" style="float: right; margin-bottom: 1rem">Gerar Ordem de Fornecimento</button>
<% end %>
<table class="records">
  <thead>
  <tr>
    <th>
      <%= SupplyOrder.human_attribute_name :number %>
    </th>
    <th>
      <%= SupplyOrder.human_attribute_name :creditor %>
    </th>
    <th>
      <%= SupplyOrder.human_attribute_name :authorization_date %>
    </th>
    <th>
      <%= SupplyOrder.human_attribute_name :licitation_process %>
    </th>
    <th>
    </th>
  </tr>
  </thead>
  <tbody>
  <% f.object.supply_orders.each do |supply_order_request| %>
    <tr>
      <td><%= supply_order_request.supply_order.number %></td>
      <td><%= supply_order_request.supply_order.decorator.creditor %></td>
      <td><%= supply_order_request.supply_order.authorization_date %></td>
      <td><%= supply_order_request.supply_order.licitation_process %></td>
      <td><%= link_to "Visualizar", edit_supply_order_path(supply_order_request.supply_order) %></td>
    </tr>
  <% end %>
  </tbody>
</table>

<script>
  $("#gen-suplly-order").click(function(){
    var licitation_process = $('#supply_request_licitation_process_id').val(),
        contract = $("#supply_request_contract_id").val(),
        purchase_solicitation = $("#supply_request_purchase_solicitation_id").val(),
        items = $(".material-id").map(function(){ return $(this).val() }).toArray().join(',');
debugger
    $("<form action="+ Routes.new_supply_order +" method='GET'/>")
        .append($('<input type="hidden" name="supply_order[licitation_process_id]">').val(licitation_process))
        .append($('<input type="hidden" name="supply_order[contract_id]">').val(contract))
        .append($('<input type="hidden" name="supply_order[purchase_solicitation_id]">').val(purchase_solicitation))
        .append($('<input type="hidden" name="supply_order[item_ids]">').val(items))
        .appendTo($(document.body)) //it has to be added somewhere into the <body>
        .submit();
  })
</script>