<h3 id="item_title"></h3>

<div id="errors_dialog" title="O formulário contém erros" class="simple_form">
  <p>Foram encontrados os seguintes erros no formulário:</p>

  <ul id="errors_content"></ul>

  <%= mustache 'error_template' do %>
    <li class="error">{{error}}</li>
  <% end %>

  <div class="buttons">
    <%= button_tag 'Ok', type: :button, id: 'close_error_dialog', class: 'button' %>
  </div>
</div>

<div class="yui3-g">
  <%= hidden_field_tag :item_id, item.id %>
  <%= hidden_field_tag :bid_id, next_bid.try(:id) %>

  <div class="yui3-u-1-12 input">
    <%= label_tag :round, PurchaseProcessTradingItemBid.human_attribute_name(:round) %>

    <%= text_field_tag :round, next_bid.try(:round), disabled: true, class: 'string' %>
  </div>

  <div class="yui3-u-1-3 input" style="width: 30rem;">
    <%= label_tag :accreditation_creditor,
      PurchaseProcessTradingItemBid.human_attribute_name(:accreditation_creditor) %>

      <%= text_field_tag :accreditation_creditor, next_bid.try(:accreditation_creditor),
        disabled: true, class: 'string' %>

    <%= hidden_field_tag :accreditation_creditor_id, next_bid.try(:purchase_process_accreditation_creditor_id) %>
  </div>

  <div class="yui3-u-1-8 input">
    <%= label_tag :amount, PurchaseProcessTradingItemBid.human_attribute_name(:amount) %>

    <%= text_field_tag :amount, amount_with_reduction(next_bid), class: 'string decimal',
      'data-decimal' => true, disabled: next_bid.blank? %>
  </div>

  <div class="yui3-u-1-8 field-without-label">
    <%= button_tag 'Gravar lance', type: :button, class: 'button primary',
      id: 'make_bid', 'data-disabled' => make_bid_disabled_message(next_bid) %>
  </div>

  <% if creditors&.count == 1 %>
    <div class="yui3-u-1-7 field-without-label">
      <%= button_tag 'Encerrar', type: :button, class: 'button primary',
                     id: 'finish_bid'%>
    </div>
  <% else %>
    <div class="yui3-u-1-7 field-without-label">
      <%= button_tag 'Sair da Disputa', type: :button, class: 'button primary ',
                     id: 'finish_dispute', 'data-disabled' => make_bid_disabled_message(next_bid)%>
    </div>
  <% end %>

  <div class="yui3-u-1-12 field-without-label">
    <%= button_tag 'Desfazer', type: :button, class: 'button negative', id: 'undo_bid',
      'data-disabled' => undo_bid_disabled_message(historic) %>
  </div>
</div>
