<%= f.input :parcel_replicated_value, :disabled => true, :input_html => { :class => 'replicated_value' } %>
<%= f.input :pledge_parcels_sum, :disabled => true, :input_html => { :value => f.object.decorator.pledge_parcels_sum } %>

<p>
  <input type="button" class="button affirmative add-pledge-parcel" value="Adicionar Vencimento">
</p>

<% if f.object.new_record? && request.get? %>
  <% f.association :pledge_parcels_attributes, :collection => f.object.pledge_parcels.build do |e| %>
      <%= render 'pledge_parcels/form', :f => e %>
  <% end %>
<% end %>

<div id="pledge-parcels">
  <%= f.association :pledge_parcels, :collection => localized(f.object.pledge_parcels) do |e| %>
    <%= render 'pledge_parcels/form', :f => e %>
  <% end %>
</div>

<%= mustache 'pledge-parcels-template' do %>
  <%= f.association :pledge_parcels_attributes, :collection => f.object.pledge_parcels.build, :index => '{{uuid_pledge_parcel}}' do |e| %>
    <%= render 'pledge_parcels/form', :f => e %>
  <% end %>
<% end %>

<script>
  $("#pledge-parcels-template").nestedForm({
    add: '.add-pledge-parcel',
    remove: '.remove-pledge-parcel',
    target: '#pledge-parcels',
    uuid: 'uuid_pledge_parcel',
    fieldToRemove: '.pledge-parcel',
    right: true
  });
</script>
