//= require_tree ./licitation_processes

$(document).ready(function() {
  function organizesModalities() {
    if ($('#licitation_process_type_of_purchase_licitation').is(':checked')){
      $('div.modality').removeClass('hidden');
      $('div.type-of-removal').addClass('hidden');
      $('label[for="licitation_process_modality_number"]').html('Nº da modalidade');
      $('a[href="#tab-items"]').html("Itens");
    } else {
      $('div.modality').addClass('hidden');
      $('div.type-of-removal').removeClass('hidden');
      $('label[for="licitation_process_modality_number"]').html('Nº do afastamento');
      $('a[href="#tab-items"]').html("Itens / Justificativa");
      $('#licitation_process_modality').val('');
      toogleVisibilityFieldsToTradingAndConcurrence();
    }
  };

  function toogleVisibilityFieldsToTradingAndConcurrence() {
    if (($('#licitation_process_modality').val() == '<%= Modality::TRADING %>' ) || ($('#licitation_process_modality').val() == '<%= Modality::CONCURRENCE %>')) {
      $('.fields-to-trading-and-concurrence').removeClass('hidden');
    } else {
      $('.fields-to-trading-and-concurrence').addClass('hidden');
      $('#licitation_process_price_registration, #licitation_process_is_trading').attr('checked', false)
    }
  };

  function toogleVisibilityFieldsToTrading() {
    if (($('#licitation_process_modality').val() == '<%= Modality::TRADING %>')) {
      $('.field-to-trading').removeClass('hidden');
      $('.not-fields-to-trading').addClass('hidden');
    } else {
      $('.field-to-trading').addClass('hidden');
      $('.not-fields-to-trading').removeClass('hidden');
    }
  };

  $('input[name="licitation_process[type_of_purchase]"]').change(function(){
    organizesModalities();
    toogleVisibilityFieldsToTrading();
    toogleVisibilityFieldsToTradingAndConcurrence();
  });

  $('#licitation_process_modality').on('change', function() {
    toogleVisibilityFieldsToTrading();
    toogleVisibilityFieldsToTradingAndConcurrence();
  });

  organizesModalities();
  toogleVisibilityFieldsToTrading();
  toogleVisibilityFieldsToTradingAndConcurrence();
});
